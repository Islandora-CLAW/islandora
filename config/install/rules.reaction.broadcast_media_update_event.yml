uuid: d58d3327-38d2-400b-91a0-3b00b3870121
langcode: en
status: true
dependencies:
  module:
    - islandora
    - rules
  enforced:
    module:
      - islandora
id: broadcast_media_update_event
label: 'Broadcast Media Update Event'
events:
  -
    event_name: 'rules_entity_update:media'
description: 'Broadcasts an ''Update'' event when a user updates a Media.'
tags:
  - ''
config_version: '3'
expression:
  id: rules_rule
  uuid: 9974766d-92df-4d92-9ba4-e5ae5dce02fd
  conditions:
    id: rules_and
    uuid: faf52a5f-beba-4b09-ac0a-f19f0d23cc52
    conditions: {  }
  actions:
    id: rules_action_set
    uuid: 7e0df904-755c-4c89-899b-9bb6212d5c6e
    actions:
      -
        id: rules_action
        uuid: bd3da549-41b5-4d92-9dbd-6dee9d35fadd
        context_values: {  }
        context_mapping:
          entity: media
          user: '@user.current_user_context:current_user'
        context_processors: {  }
        provides_mapping: {  }
        action_id: islandora_update_event_generator
      -
        id: rules_action
        uuid: 6aa1f15c-3a39-4af5-b577-81fa7081de62
        context_values:
          recipients:
            - 'activemq:queue:islandora-indexing-triplestore'
        context_mapping:
          message: event_message
        context_processors:
          recipients:
            rules_tokens: {  }
        provides_mapping: {  }
        action_id: islandora_broadcast
