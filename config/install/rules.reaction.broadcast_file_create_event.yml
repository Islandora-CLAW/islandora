uuid: 5a444d61-ac7f-4cde-a8b7-2693bd825753
langcode: en
status: true
dependencies:
  enforced:
    module:
      - islandora
id: broadcast_file_create_event
label: 'Broadcast File Create Event'
events:
  -
    event_name: 'rules_entity_insert:file'
description: 'Broadcasts an AS2 event to a message broker when a File is created.'
tags:
  - ''
config_version: '3'
expression:
  id: rules_rule
  uuid: 54c6585d-453d-4143-8e54-760019f251d5
  conditions:
    id: rules_and
    uuid: d82f7041-6522-4127-9676-d5534f7c1684
    conditions: {  }
  actions:
    id: rules_action_set
    uuid: 0dc80d3b-2a60-4a47-afd6-4026d0fdffe6
    actions:
      -
        id: rules_action
        uuid: 0e42b62d-39ca-4f51-baa5-fdd1b37605fe
        context_values: {  }
        context_mapping:
          entity: file
          user: '@user.current_user_context:current_user'
        context_processors: {  }
        provides_mapping: {  }
        action_id: islandora_create_event_generator
      -
        id: rules_action
        uuid: bcbbe914-54a9-4ff2-9d4b-98945682e087
        context_values:
          recipients:
            - 'activemq:queue:islandora-indexing-fcrepo-file'
        context_mapping:
          message: event_message
        context_processors:
          recipients:
            rules_tokens: {  }
        provides_mapping: {  }
        action_id: islandora_broadcast
